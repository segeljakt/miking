name: Miking CI

on: [push]

jobs:
  build-and-test:
    strategy:
      matrix:
        operating-system: [macos-latest, ubuntu-latest, windows-latest]
        ocaml-version: [ '4.09.0', '4.08.1' ]

    runs-on: ${{ matrix.operating-system }}

    steps:
    - name: Checkout
      uses: actions/checkout@master
      with:
        ref: develop

    - name: Install Ocaml
      uses: avsm/setup-ocaml@master
      with:
        ocaml-version: ${{ matrix.ocaml-version }}

    - name: Compile
      run: make

    - name: Test
      run: make test

    - name: Clean
      run: make clean
